## Олимпиада ISC 2016 CompSec Challenge

### Описание

Задания традиционной олимпиады по компьютерной безопасности, посвященной Дню кафедры защиты информации и криптографии Томского государственного университета.

### Задание 1.

Какое преобразование делает этот код?

```
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('3=[b(6){d\'I\'},b(6){d o.W(6)},b(6){d 6[0].X(6[1])},b(6){d 6[0].U=6[1]},b(6){d S},b(6){\'V\'},b(6){d\'J\'},b(6){6.r.q=\'N\';d 6},b(6){f.O=6},b(6){f.M=6},h i("6","d K(L(Q.R(6)))"),b(6){u=h i(\'6\',3[10](e[6]));d u}];g=[0,T,1];e=[\'z=\',\'A\',\'y==\',\'x=\',\'\',\'j\',\'v\',\'w=\',\'\',\'B+C+H/G/F/D+E+P/18+1f+1e+1d/1g/1h\',\'1j=\',\'1i=\',\'1c==\',\'1b==\',\'Y\'];o=3[11](11)();s=h i(\'6\',3[10](e[10]));f=3[7](3[11](13)());3[8](b(){t=s(e[5]);c=3[1](3[11](0)());c.l=f.l;c.n=f.n;c.r.q=3[11](1)();m=e[4];a=3[2]([c,3[11](2)()]);19=h i(\'6\',3[10](e[14]));a.Z(f,g[0],g[0]);k=a.15(g[0],g[0],c.l,c.n);p=3[11](12)();(h i(3[10](m)))();j=3[4](a);f=3[4](j);c=3[4](c);a=3[4](k);k=3[4](a);16=3[4](a);m=3[4](a);1k=3[4](a);1a=3[4](a);j=3[4](a);17=3[4](a);o=3[4](a);p=3[4](a);e=3[4](a);g=3[4](a);6=3[4](a);6=3[4](t);3=3[4](a)});p=3[9](3[11](7)()+e[9]);',62,83,'|||v9590e2cf04e941a01b43d16391df12b0|||vca97b68af07e029f4640ed675e4706dc||||v11b454573e6e4ebafe09d8b90d693382|function|v0f6ab80701c480ef2b182245838f1f97|return|v21a3d2d3fc5c2c1e1f3a633bd8f16f7e|vbead4e3448e69b413ba0c87ff90d507f|v2f0d7321e56dfd45d6862b1f7364f5d9|new|Function|v49b95c67a63c24111af8a21100b5ee59|v34c5f75066841eabeffdb886c4ec9f5a|width|ve2d752681e9bab8acf2f34cbf4af8d75|height|v65bfd2deb567d4f0affc206e90a4255d|v2290b7fd3c5ee838b1053732d5d3c7f7|display|style|v0855c6ef64834a9daa81a4f9c60b824e|v16957d1f93fee1f4c1a30a3082fe3731|v4fd4dec671f34cc802b9adf72ecbfa57|v82b4517b96ffe909d032fa53ab0507d8|cmV0dXJuJTIwJ2RhdGElM0FpbWFnZSUyRnBuZyUzQmJhc2U2NCUyQyclM0I|cmV0dXJuJTIwJ3NjcmlwdCclM0I|cmV0dXJuJTIwJzJkJyUzQg|cmV0dXJuJTIwJ2NhbnZhcyclM0I|cmV0dXJuJTIwJ25vbmUnJTNC|iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAIAAACQKrqGAAABbklEQVQokTWJ7UvTcQAHz|8OajYz2iJTUMwhSlQahBS|jPwheoxSMz1F7YhT8SnIGuHMkxDEKHktvhHNrQTZ6ZNozCInRgGkbYJCdyN4UabJKL0MIDvIinRDOP7|JYsgqTSY3a0lKb51TgtlyGx|soI9siKNJM5PQktMxG2oa11SlbMhB7Ca1iOm7gjE0kD3kNLl7VPrqJNuCJTcZJc6Trpxw9kZN6En6SvC|cuwewBRQmxbTTUMhWJ1eLjb70Q3xx33NjGxkaCTbKHq3An6WKPrMIAe7IediDKj7hG|7UX4V|f1e75747bc4c6d0b16f0d429b76d23f1c06153a904bfafd40ceb08152cc46594b8ac5bb1|4c87e5e9fc1a564781c398618687a2f5cad0abb8637dc3b97dcf2d564e2003f67e7c26aa|unescape|decodeURIComponent|src|none|onload|ZW8TOlAYsV45bTlEvLXJH7ZF8X4CW5lIvYgVfmEM6lHp7oKTlGDuWMTMMnfBEeSAm|window|atob|null|255|text|05580caed314df2d74c3e515d57294928cfbfae6fcca7fc550bdb3a2065482bbaf49830b|createElement|getContext|cmV0dXJuJTIwU3RyaW5nLmZyb21DaGFyQ29kZSh2Y2E5N2I2OGFmMDdlMDI5ZjQ2NDBlZDY3NWU0NzA2ZGMpJTNC|drawImage||||||getImageData|vef2a9e47fd7e579514f95dc5e7992a0a|v2415860ec22ead1ef675f0e4cf6cfb8d|cEiewkC|v002c79abc568c3afe5e46187d164de7e|vfa35343e480c151295dd61049c36e8cf|cmV0dXJuJTIwbmV3JTIwSW1hZ2UoKSUzQg|Zm9yKHZlZjJhOWU0N2ZkN2U1Nzk1MTRmOTVkYzVlNzk5MmEwYSUzRHYyZjBkNzMyMWU1NmRmZDQ1ZDY4NjJiMWY3MzY0ZjVkOSU1QjIlNUQlM0IlMjB2ZWYyYTllNDdmZDdlNTc5NTE0Zjk1ZGM1ZTc5OTJhMGElMjAlM0MlMjB2MzRjNWY3NTA2Njg0MWVhYmVmZmRiODg2YzRlYzlmNWEuZGF0YS5sZW5ndGglM0IlMjB2ZWYyYTllNDdmZDdlNTc5NTE0Zjk1ZGM1ZTc5OTJhMGElMkIlM0Q0KXZlMmQ3NTI2ODFlOWJhYjhhY2YyZjM0Y2JmNGFmOGQ3NSUyQiUzRCh2MzRjNWY3NTA2Njg0MWVhYmVmZmRiODg2YzRlYzlmNWEuZGF0YSU1QnZlZjJhOWU0N2ZkN2U1Nzk1MTRmOTVkYzVlNzk5MmEwYSU1RCElM0R2MmYwZDczMjFlNTZkZmQ0NWQ2ODYyYjFmNzM2NGY1ZDklNUIxJTVEKSUzRnYwMDJjNzlhYmM1NjhjM2FmZTVlNDYxODdkMTY0ZGU3ZSh2MzRjNWY3NTA2Njg0MWVhYmVmZmRiODg2YzRlYzlmNWEuZGF0YSU1QnZlZjJhOWU0N2ZkN2U1Nzk1MTRmOTVkYzVlNzk5MmEwYSU1RCklM0F2MjFhM2QyZDNmYzVjMmMxZTFmM2E2MzNiZDhmMTZmN2UlNUI0JTVEJTNCJTIwdmUyZDc1MjY4MWU5YmFiOGFjZjJmMzRjYmY0YWY4ZDc1JTNEdmUyZDc1MjY4MWU5YmFiOGFjZjJmMzRjYmY0YWY4ZDc1LnRyaW0oKSUzQg|3ysCoNS50yCLNVOYNhKVNhvCr3qny3alA9KjINx2Yu|FbWCN92SJDaJF53IcuLsKMdqi1G|hgHMUlKPb|iYfBQRIthRu8lp2CbBFUHKzFALXECH|AXPEud2VavCcAAAAAElFTkSuQmCC|cmV0dXJuJTIwZG9jdW1lbnQ|cmV0dXJuJTIwdjY1YmZkMmRlYjU2N2Q0ZjBhZmZjMjA2ZTkwYTQyNTVkLmdldEVsZW1lbnRCeUlkKHZjYTk3YjY4YWYwN2UwMjlmNDY0MGVkNjc1ZTQ3MDZkYyklM0I|v44dd65312df364a378e0a8173770c888'.split('|'),0,{}))
```

### Задание 2.

Предоставьте фамилию и имя владельца номера телефона: 89528073922. Звонить, отсылать SMS и MMS на этот номер запрещено.

### Задание 3.

Найти флаг в [сетевом дампе](isc.pcap).

### Задание 4 (исправленное и дополненное).
Написать регулярное выражение наименьшей длины позволяющее эффективно обнаруживать атаки XSS. Для минимальных тестов использовать приведенные ниже тестовые данные.

Вектора XSS:

```
<script>alert(1);</script>
"><img src=1 onerror='javascript:alert(1)'>
"/><img/onerror=\x09javascript:alert(1)\x09src=xxx:x />
<video poster=javascript:javascript:alert(1)//
'; alert(1);//
aa"}]};alert(1);var foo={"a":[{"bb":"cc"
" onerror=alert(1) "
```
Обычные данные:

```
<img src='http://example.com/1.jpg'>Cool picture</img>
Is it 100 > 2 ?
150763447.1860448730.1445593431.1446723513.1446723513.1
a=1
;->
8-(3822)-777-88-99
To enable JavaScript on a page you should place your code in the <script> tag
```

### Задание 5.
Какие уязвимости содержатся в следующем фрагменте кода?
Каким образом можно воспользоваться данными уязвимостями для проведения атаки на систему? Описать последовательность выполняемых действий.

 ```
<?php
$file = rawurldecode($_REQUEST['file']);
$file = preg_replace('/^.+[\\\\\\/]/', '', $file);
include("/inc/{$file}.php");
?>
```

### Задание 6.
При обращении к URL вида `http://example.com/form?foo=test` значение параметра `foo` вставляется в форму без всякой предварительной обработки:

```
<form action="/form">
  <input name='foo' type='text' value='test'>
  <input name='bar' type='text' value='baz'>
  <input name='token' type='text' value='807423475023846034058234758345727'>
  <input type='submit' value='Submit'>
</form>
```
Написать эксплоит наименьшей длины, который позволяет украсть (т.е. отправить его злоумышленнику) значение параметра `token`.

### Задание 7.
Как можно точнее оценить количество людей на [фотографии](peoples.jpg).

### Задание 8.
Какой снегоход был у ректора Томского государственного университета в 2013 году.

### Задание 9.
Какие уязвимости содержатся в следующем фрагменте кода? Каким образом можно воспользоваться данными уязвимостями для проведения атаки на систему? Описать последовательность выполняемых действий.

```
<?php
*
CREATE TABLE `message` (
`remote_addr` TEXT NOT NULL ,
`user_agent` TEXT NOT NULL ,
`name` TEXT NOT NULL ,
`text` TEXT NOT NULL
) ENGINE = MYISAM ;
INSERT INTO `message` (`remote_addr`, `user_agent`, `name`, `text`) VALUES('127.0.0.0', 'Fire Walk With Me', 'test name', 'test text');
INSERT INTO `message` (`remote_addr`, `user_agent`, `name`, `text`) VALUES('127.0.0.0', 'Abandon all hope, ye who enter here', 'test name2', 'test text2');
*/
 
$link = mysql_connect("localhost", "root", "");
mysql_select_db("positive", $link);
$ip = $_SERVER["REMOTE_ADDR"];
if(isset($_SERVER["HTTP_X_REAL_IP"])) {
    $ip = $_SERVER["HTTP_X_REAL_IP"];
}
$ip = addslashes($ip);
$user_agent = addslashes($_SERVER["HTTP_USER_AGENT"]);
$ip = substr($ip, 0, 15); // max length 15
if(isset($_POST["name"]) && isset($_POST["text"])) {
    $text = addslashes($_POST["text"]);
    $name = addslashes($_POST["name"]);
    $query = mysql_query("INSERT INTO `message` (`remote_addr`, `user_agent`, `name`, `text`) VALUES('{$ip}', '{$user_agent}', '{$name}', '{$text}');", $link);
}
$query = mysql_query("SELECT * FROM `message`;", $link);
echo("<table>");
while($row = mysql_fetch_assoc($query)) {
   echo("<tr><td>{$row["name"]}</td><td>{$row["text"]}</td></tr>");
}
echo("</table>");
?>
```

### Задание 10.
Когда Алиса и Боб были маленькими они использовали собственные шифры. Однажды Алиса прочитала книгу [Милтона Эриксона](https://en.wikipedia.org/wiki/Milton_H._Erickson) и решила написать Бобу одну итересную идею. Что Алиса написала Бобу?
```
AъуъавътсесъоварпиьъиъивирпъяигелъерепъюовсьтижъутчемъоназъмкатиовъатчеъиетйъйыджакъаръадгокзъмывътчеъеаъетA
```

Решения присылать на адрес dnkolegov@yandex.ru.
